{% extends 'base.html' %}
{% block content %}
<div class="container">
  <h1>{{ 'Edit sample' if sample else 'New sample' }}</h1>
  <form method="post" novalidate>
    <div class="field">
      <label for="patient_id">Patient</label>
      <select id="patient_id" name="patient_id" aria-label="Select patient">
        {% for p in patients %}
          <option value="{{ p.id }}" {% if sample and sample.patient_id == p.id %}selected{% endif %}>{{ p.full_name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="field">
      <label for="sample_type">Sample type</label>
      <input id="sample_type" name="sample_type" required value="{{ sample.sample_type if sample else '' }}" list="types">
      <datalist id="types">
        <option>Blood</option>
        <option>Urine</option>
        <option>Swab</option>
        <option>CSF</option>
      </datalist>
    </div>
    <div class="field">
      <label for="collection_datetime">Collection date/time</label>
      <input type="datetime-local" id="collection_datetime" name="collection_datetime"
             value="{{ sample.collection_datetime.strftime('%Y-%m-%dT%H:%M') if sample else '' }}">
    </div>
    <div class="field">
      <label for="status">Status</label>
      <select id="status" name="status">
        {% for st in ['received','processing','completed','rejected'] %}
          <option {% if sample and sample.status == st %}selected{% endif %}>{{ st }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="actions">
      <button class="btn" type="submit">Save</button>
      <a class="btn secondary" href="{{ url_for('main.samples_list') }}">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}
